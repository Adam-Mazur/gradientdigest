{% extends "base.html" %}
{% block styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='home_page_styles.css') }}">
{% endblock %}
{% block body %}
<ul class="navbar">
    <img class="logo" src="{{ url_for('static', filename='images/Logo.png') }}">
    <form action="/" method="POST">
        <input type="text" id="search" name="search" placeholder="Search">
    </form>
    <li class="navbar-element">About</li>
    <a href="{{ url_for('logout') }}">
        <li class="navbar-element">Logout</li>
    </a>
</ul>
<div class="main">
    <div class="header">
        <p class="text-banner">
            Top results from last week
        </p>
        <p class="sort-options">
            Sort by <span style="font-weight: 700;">Popularity</span>
        </p>
    </div>
    {% for paper in papers %}
    <div class="article">
        <span class="article-title">{{ paper.title }}</span>
        <span class="authors">
            {{ paper.authors }}
        </span>
        <p class="abstract">
            {{ paper.abstract }}
        </p>
        <div>
            <span class="article-meta">{{ paper.submited_date | display_date }}</span>
            <div class="indicator" style="background-color: #FF7A00;"></div>
            <span class="article-meta">Relevance</span>
            <div class="indicator" style="background-color: #00B612;"></div>
            <span class="article-meta">Popularity</span>
        </div>
        <div class="article-sidebar">
            <input type="checkbox" id="{{ paper.id }}" class="like-button" {% if current_user in paper.users%} checked {% endif %}>
            <label for="{{ paper.id }}"></label>
            <ul>
                <li class="sidebar-link"><a href="{{ paper.site_link }}" target="_blank">Site</a></li>
                <li class="sidebar-link"><a href="{{ paper.pdf_link }}" target="_blank">PDF</a></li>
            </ul>
        </div>
    </div>
    {% endfor %}
    <div class="next-page">
        <a href="{{ url_for('home_page', page=page_number_1) }}">
            <button class="page-button" {% if current_page == page_number_1 %} id="current-page" {% endif %} >
                {{ page_number_1 }}
            </button>
        {% if number_of_pages >= 2 %}
        </a>
        <a href="{{ url_for('home_page', page=page_number_2) }}">
            <button class="page-button" {% if current_page == page_number_2 %} id="current-page" {% endif %}>
                {{ page_number_2 }}
            </button>
        </a>
        {% endif %}
        {% if number_of_pages >= 3 %}
        <a href="{{ url_for('home_page', page=page_number_3) }}">
            <button class="page-button" {% if current_page == page_number_3 %} id="current-page" {% endif %}>
                {{ page_number_3 }}
            </button>
        </a>
        {% endif %}
    </div>
</div>
<script>
    like_buttons = document.getElementsByClassName('like-button');
    for (let button of like_buttons) {
        button.addEventListener('change', (event) => {
            fetch('/', {
                method: 'POST',
                body: JSON.stringify({[button.id]: button.checked}),
                headers: new Headers({'content-type': 'application/json'}),
            });
        })
    }
</script>
{% endblock %}